---
keywords: fastai
description: A simple cheatsheet for the Python equivalent of the most common Alteryx data prep tools
title: Python for Alteryx users
toc: true
badges: true
comments: false
image: images/header_images/alteryx-to-python.png
categories: [Alteryx, Python]
nb_path: _notebooks/2020-05-24-python-for-alteryx-users.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-24-python-for-alteryx-users.ipynb
-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Overview-of-tools">Overview of tools<a class="anchor-link" href="#Overview-of-tools"> </a></h1><p>We will recreate this Alteryx workflow using Python</p>
<p><img src="/images/copied_from_nb/python-for-alteryx-users//Alteryx_workflow.PNG" alt="Alteryx workflow"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Text-input">Text input<a class="anchor-link" href="#Text-input"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/text-input.png" alt="Text Input"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">text_input</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;Person&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;You&quot;</span><span class="p">,</span> <span class="s2">&quot;Me&quot;</span><span class="p">,</span> <span class="s2">&quot;Everyone else&quot;</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">]}</span>
<span class="p">)</span>
<span class="n">text_input</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Person</th>
      <th>Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>You</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Me</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Everyone else</td>
      <td>99</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Input-data">Input data<a class="anchor-link" href="#Input-data"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/normal-input.png" alt="Input data"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">input_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://query.data.world/s/whbjtalht4sigazly6hdnnb5ynqald&quot;</span><span class="p">)</span>
<span class="n">input_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>City</th>
      <th>Country</th>
      <th>Customer Name</th>
      <th>Discount</th>
      <th>Number of Records</th>
      <th>Order Date</th>
      <th>Order ID</th>
      <th>Postal Code</th>
      <th>Manufacturer</th>
      <th>Product Name</th>
      <th>Profit</th>
      <th>Quantity</th>
      <th>Region</th>
      <th>Sales</th>
      <th>Segment</th>
      <th>Ship Date</th>
      <th>Ship Mode</th>
      <th>State</th>
      <th>Sub-Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Furniture</td>
      <td>Henderson</td>
      <td>United States</td>
      <td>Claire Gute</td>
      <td>0.00</td>
      <td>1</td>
      <td>11/8/2017</td>
      <td>CA-2017-152156</td>
      <td>42420.0</td>
      <td>Bush</td>
      <td>Bush Somerset Collection Bookcase</td>
      <td>41.9136</td>
      <td>2</td>
      <td>South</td>
      <td>261.9600</td>
      <td>Consumer</td>
      <td>11/11/2017</td>
      <td>Second Class</td>
      <td>Kentucky</td>
      <td>Bookcases</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Furniture</td>
      <td>Henderson</td>
      <td>United States</td>
      <td>Claire Gute</td>
      <td>0.00</td>
      <td>1</td>
      <td>11/8/2017</td>
      <td>CA-2017-152156</td>
      <td>42420.0</td>
      <td>Hon</td>
      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>
      <td>219.5820</td>
      <td>3</td>
      <td>South</td>
      <td>731.9400</td>
      <td>Consumer</td>
      <td>11/11/2017</td>
      <td>Second Class</td>
      <td>Kentucky</td>
      <td>Chairs</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Office Supplies</td>
      <td>Los Angeles</td>
      <td>United States</td>
      <td>Darrin Van Huff</td>
      <td>0.00</td>
      <td>1</td>
      <td>6/12/2017</td>
      <td>CA-2017-138688</td>
      <td>90036.0</td>
      <td>Universal</td>
      <td>Self-Adhesive Address Labels for Typewriters b...</td>
      <td>6.8714</td>
      <td>2</td>
      <td>West</td>
      <td>14.6200</td>
      <td>Corporate</td>
      <td>6/16/2017</td>
      <td>Second Class</td>
      <td>California</td>
      <td>Labels</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Furniture</td>
      <td>Fort Lauderdale</td>
      <td>United States</td>
      <td>Sean O'Donnell</td>
      <td>0.45</td>
      <td>1</td>
      <td>10/11/2016</td>
      <td>US-2016-108966</td>
      <td>33311.0</td>
      <td>Bretford</td>
      <td>Bretford CR4500 Series Slim Rectangular Table</td>
      <td>-383.0310</td>
      <td>5</td>
      <td>South</td>
      <td>957.5775</td>
      <td>Consumer</td>
      <td>10/18/2016</td>
      <td>Standard Class</td>
      <td>Florida</td>
      <td>Tables</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Office Supplies</td>
      <td>Fort Lauderdale</td>
      <td>United States</td>
      <td>Sean O'Donnell</td>
      <td>0.20</td>
      <td>1</td>
      <td>10/11/2016</td>
      <td>US-2016-108966</td>
      <td>33311.0</td>
      <td>Eldon</td>
      <td>Eldon Fold 'N Roll Cart System</td>
      <td>2.5164</td>
      <td>2</td>
      <td>South</td>
      <td>22.3680</td>
      <td>Consumer</td>
      <td>10/18/2016</td>
      <td>Standard Class</td>
      <td>Florida</td>
      <td>Storage</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Select-tool">Select tool<a class="anchor-link" href="#Select-tool"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/select.png" alt="Select tool"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selected_data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">input_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ship Date&quot;</span><span class="p">,</span> <span class="s2">&quot;Ship Mode&quot;</span><span class="p">])</span>  <span class="c1"># Example of deselecting</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="p">:,</span> <span class="p">[</span><span class="s2">&quot;Order ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Sub-Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Product Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Quantity&quot;</span><span class="p">]</span>
    <span class="p">]</span>  <span class="c1"># Example of selecting</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Sub-Category&quot;</span><span class="p">:</span> <span class="s2">&quot;Sub-Cat&quot;</span><span class="p">,</span> <span class="s2">&quot;Product Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Product&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s2">&quot;Quantity&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;Category&quot;</span><span class="p">:</span> <span class="s2">&quot;str&quot;</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">selected_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order ID</th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Product</th>
      <th>Sales</th>
      <th>Quantity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA-2017-152156</td>
      <td>Furniture</td>
      <td>Bookcases</td>
      <td>Bush Somerset Collection Bookcase</td>
      <td>261.9600</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CA-2017-152156</td>
      <td>Furniture</td>
      <td>Chairs</td>
      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>
      <td>731.9400</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CA-2017-138688</td>
      <td>Office Supplies</td>
      <td>Labels</td>
      <td>Self-Adhesive Address Labels for Typewriters b...</td>
      <td>14.6200</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US-2016-108966</td>
      <td>Furniture</td>
      <td>Tables</td>
      <td>Bretford CR4500 Series Slim Rectangular Table</td>
      <td>957.5775</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US-2016-108966</td>
      <td>Office Supplies</td>
      <td>Storage</td>
      <td>Eldon Fold 'N Roll Cart System</td>
      <td>22.3680</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Formula-tool">Formula tool<a class="anchor-link" href="#Formula-tool"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/formula.png" alt="Formula tool"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selected_data</span><span class="p">[</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_data</span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">selected_data</span><span class="p">[</span><span class="s2">&quot;Quantity&quot;</span><span class="p">]</span>
<span class="n">selected_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order ID</th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Product</th>
      <th>Sales</th>
      <th>Quantity</th>
      <th>Total Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA-2017-152156</td>
      <td>Furniture</td>
      <td>Bookcases</td>
      <td>Bush Somerset Collection Bookcase</td>
      <td>261.9600</td>
      <td>2</td>
      <td>523.9200</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CA-2017-152156</td>
      <td>Furniture</td>
      <td>Chairs</td>
      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>
      <td>731.9400</td>
      <td>3</td>
      <td>2195.8200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CA-2017-138688</td>
      <td>Office Supplies</td>
      <td>Labels</td>
      <td>Self-Adhesive Address Labels for Typewriters b...</td>
      <td>14.6200</td>
      <td>2</td>
      <td>29.2400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US-2016-108966</td>
      <td>Furniture</td>
      <td>Tables</td>
      <td>Bretford CR4500 Series Slim Rectangular Table</td>
      <td>957.5775</td>
      <td>5</td>
      <td>4787.8875</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US-2016-108966</td>
      <td>Office Supplies</td>
      <td>Storage</td>
      <td>Eldon Fold 'N Roll Cart System</td>
      <td>22.3680</td>
      <td>2</td>
      <td>44.7360</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Filter-tool">Filter tool<a class="anchor-link" href="#Filter-tool"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/filter.png" alt="Filter tool"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filtered_data</span> <span class="o">=</span> <span class="n">selected_data</span><span class="p">[</span><span class="n">selected_data</span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">]</span>


<span class="c1"># To get the false</span>
<span class="n">sales_under_1000</span> <span class="o">=</span> <span class="n">selected_data</span><span class="p">[</span><span class="n">selected_data</span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">]</span>

<span class="n">filtered_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order ID</th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Product</th>
      <th>Sales</th>
      <th>Quantity</th>
      <th>Total Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>CA-2015-115812</td>
      <td>Furniture</td>
      <td>Tables</td>
      <td>Chromcraft Rectangular Conference Tables</td>
      <td>1706.184</td>
      <td>9</td>
      <td>15355.656</td>
    </tr>
    <tr>
      <th>24</th>
      <td>CA-2016-106320</td>
      <td>Furniture</td>
      <td>Tables</td>
      <td>Bretford CR4500 Series Slim Rectangular Table</td>
      <td>1044.630</td>
      <td>3</td>
      <td>3133.890</td>
    </tr>
    <tr>
      <th>27</th>
      <td>US-2016-150630</td>
      <td>Furniture</td>
      <td>Bookcases</td>
      <td>Riverside Palais Royal Lawyers Bookcase, Royal...</td>
      <td>3083.430</td>
      <td>7</td>
      <td>21584.010</td>
    </tr>
    <tr>
      <th>35</th>
      <td>CA-2017-117590</td>
      <td>Technology</td>
      <td>Phones</td>
      <td>GE 30524EE4</td>
      <td>1097.544</td>
      <td>7</td>
      <td>7682.808</td>
    </tr>
    <tr>
      <th>54</th>
      <td>CA-2017-105816</td>
      <td>Technology</td>
      <td>Phones</td>
      <td>AT&amp;T CL83451 4-Handset Telephone</td>
      <td>1029.950</td>
      <td>5</td>
      <td>5149.750</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sales_under_1000</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order ID</th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Product</th>
      <th>Sales</th>
      <th>Quantity</th>
      <th>Total Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA-2017-152156</td>
      <td>Furniture</td>
      <td>Bookcases</td>
      <td>Bush Somerset Collection Bookcase</td>
      <td>261.9600</td>
      <td>2</td>
      <td>523.9200</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CA-2017-152156</td>
      <td>Furniture</td>
      <td>Chairs</td>
      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>
      <td>731.9400</td>
      <td>3</td>
      <td>2195.8200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CA-2017-138688</td>
      <td>Office Supplies</td>
      <td>Labels</td>
      <td>Self-Adhesive Address Labels for Typewriters b...</td>
      <td>14.6200</td>
      <td>2</td>
      <td>29.2400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US-2016-108966</td>
      <td>Furniture</td>
      <td>Tables</td>
      <td>Bretford CR4500 Series Slim Rectangular Table</td>
      <td>957.5775</td>
      <td>5</td>
      <td>4787.8875</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US-2016-108966</td>
      <td>Office Supplies</td>
      <td>Storage</td>
      <td>Eldon Fold 'N Roll Cart System</td>
      <td>22.3680</td>
      <td>2</td>
      <td>44.7360</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sort-tool">Sort tool<a class="anchor-link" href="#Sort-tool"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/sort.png" alt="Sort tool"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sorted_data</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sorted_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order ID</th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Product</th>
      <th>Sales</th>
      <th>Quantity</th>
      <th>Total Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9941</th>
      <td>CA-2015-145317</td>
      <td>Technology</td>
      <td>Machines</td>
      <td>Cisco TelePresence System EX90 Videoconferenci...</td>
      <td>22638.480</td>
      <td>6</td>
      <td>135830.880</td>
    </tr>
    <tr>
      <th>8093</th>
      <td>CA-2017-118689</td>
      <td>Technology</td>
      <td>Copiers</td>
      <td>Canon imageCLASS 2200 Advanced Copier</td>
      <td>17499.950</td>
      <td>5</td>
      <td>87499.750</td>
    </tr>
    <tr>
      <th>4905</th>
      <td>CA-2018-140151</td>
      <td>Technology</td>
      <td>Copiers</td>
      <td>Canon imageCLASS 2200 Advanced Copier</td>
      <td>13999.960</td>
      <td>4</td>
      <td>55999.840</td>
    </tr>
    <tr>
      <th>9707</th>
      <td>CA-2018-127180</td>
      <td>Technology</td>
      <td>Copiers</td>
      <td>Canon imageCLASS 2200 Advanced Copier</td>
      <td>11199.968</td>
      <td>4</td>
      <td>44799.872</td>
    </tr>
    <tr>
      <th>5297</th>
      <td>CA-2018-166709</td>
      <td>Technology</td>
      <td>Copiers</td>
      <td>Canon imageCLASS 2200 Advanced Copier</td>
      <td>10499.970</td>
      <td>3</td>
      <td>31499.910</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summarize-tool">Summarize tool<a class="anchor-link" href="#Summarize-tool"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/summarize.png" alt="Summarize tool"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">summarized_data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">sorted_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Sub-Cat&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;Sales&quot;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Sales by Sub-Cat&quot;</span><span class="p">})</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">summarized_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Sales by Sub-Cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Furniture</td>
      <td>Bookcases</td>
      <td>49521.8256</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Furniture</td>
      <td>Chairs</td>
      <td>129547.8520</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Furniture</td>
      <td>Furnishings</td>
      <td>5638.9320</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Furniture</td>
      <td>Tables</td>
      <td>102125.0490</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Office Supplies</td>
      <td>Appliances</td>
      <td>36742.7900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">summarized_data_alternative</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Sub-Cat&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">Sales_by_Sub_Cat</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="nb">sum</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">summarized_data_alternative</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Sales_by_Sub_Cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Furniture</td>
      <td>Bookcases</td>
      <td>49521.8256</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Furniture</td>
      <td>Chairs</td>
      <td>129547.8520</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Furniture</td>
      <td>Furnishings</td>
      <td>5638.9320</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Furniture</td>
      <td>Tables</td>
      <td>102125.0490</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Office Supplies</td>
      <td>Appliances</td>
      <td>36742.7900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Join-tool">Join tool<a class="anchor-link" href="#Join-tool"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/join.png" alt="Join tool"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joined_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">sorted_data</span><span class="p">,</span> <span class="n">summarized_data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Sub-Cat&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span>
<span class="p">)</span>
<span class="n">joined_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order ID</th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Product</th>
      <th>Sales</th>
      <th>Quantity</th>
      <th>Total Sales</th>
      <th>Sales by Sub-Cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA-2015-145317</td>
      <td>Technology</td>
      <td>Machines</td>
      <td>Cisco TelePresence System EX90 Videoconferenci...</td>
      <td>22638.480</td>
      <td>6</td>
      <td>135830.880</td>
      <td>162022.19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>US-2017-107440</td>
      <td>Technology</td>
      <td>Machines</td>
      <td>3D Systems Cube Printer, 2nd Generation, Magenta</td>
      <td>9099.930</td>
      <td>7</td>
      <td>63699.510</td>
      <td>162022.19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CA-2017-158841</td>
      <td>Technology</td>
      <td>Machines</td>
      <td>HP Designjet T520 Inkjet Large Format Printer ...</td>
      <td>8749.950</td>
      <td>5</td>
      <td>43749.750</td>
      <td>162022.19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CA-2015-139892</td>
      <td>Technology</td>
      <td>Machines</td>
      <td>Lexmark MX611dhe Monochrome Laser Printer</td>
      <td>8159.952</td>
      <td>8</td>
      <td>65279.616</td>
      <td>162022.19</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US-2018-168116</td>
      <td>Technology</td>
      <td>Machines</td>
      <td>Cubify CubeX 3D Printer Triple Head Print</td>
      <td>7999.980</td>
      <td>4</td>
      <td>31999.920</td>
      <td>162022.19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">left_join</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">sorted_data</span><span class="p">,</span> <span class="n">summarized_data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Sub-Cat&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">left_join</span> <span class="o">=</span> <span class="n">left_join</span><span class="p">[</span><span class="n">left_join</span><span class="p">[</span><span class="s2">&quot;_merge&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;left_only&quot;</span><span class="p">]</span>
<span class="n">left_join</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;_merge&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">left_join</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order ID</th>
      <th>Category</th>
      <th>Sub-Cat</th>
      <th>Product</th>
      <th>Sales</th>
      <th>Quantity</th>
      <th>Total Sales</th>
      <th>Sales by Sub-Cat</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Union-tool">Union tool<a class="anchor-link" href="#Union-tool"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/union.png" alt="Union tool"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unioned_data</span> <span class="o">=</span> <span class="n">joined_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sales_under_1000</span><span class="p">)</span>
<span class="n">unioned_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Order ID</th>
      <th>Product</th>
      <th>Quantity</th>
      <th>Sales</th>
      <th>Sales by Sub-Cat</th>
      <th>Sub-Cat</th>
      <th>Total Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Technology</td>
      <td>CA-2015-145317</td>
      <td>Cisco TelePresence System EX90 Videoconferenci...</td>
      <td>6</td>
      <td>22638.480</td>
      <td>162022.19</td>
      <td>Machines</td>
      <td>135830.880</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Technology</td>
      <td>US-2017-107440</td>
      <td>3D Systems Cube Printer, 2nd Generation, Magenta</td>
      <td>7</td>
      <td>9099.930</td>
      <td>162022.19</td>
      <td>Machines</td>
      <td>63699.510</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Technology</td>
      <td>CA-2017-158841</td>
      <td>HP Designjet T520 Inkjet Large Format Printer ...</td>
      <td>5</td>
      <td>8749.950</td>
      <td>162022.19</td>
      <td>Machines</td>
      <td>43749.750</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Technology</td>
      <td>CA-2015-139892</td>
      <td>Lexmark MX611dhe Monochrome Laser Printer</td>
      <td>8</td>
      <td>8159.952</td>
      <td>162022.19</td>
      <td>Machines</td>
      <td>65279.616</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Technology</td>
      <td>US-2018-168116</td>
      <td>Cubify CubeX 3D Printer Triple Head Print</td>
      <td>4</td>
      <td>7999.980</td>
      <td>162022.19</td>
      <td>Machines</td>
      <td>31999.920</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Output-tool">Output tool<a class="anchor-link" href="#Output-tool"> </a></h2><p><img src="/images/copied_from_nb/python-for-alteryx-users/output.png" alt="Output tool"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unioned_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;Sales summary.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

